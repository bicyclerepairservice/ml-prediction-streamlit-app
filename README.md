# Отчёт по первой части проекта: анализ данных, построение модели и разработка сервиса

*(Документ разработан при помощи LLM)*

## 1. Что было сделано  
Краткое описание этапов работы:

### 1.1. EDA — исследовательский анализ
- Визуализация распределений числовых признаков
- Анализ и предобработка категориальных переменных через OHE
- Корреляционный анализ (Пирсон, Kendall Tau, Phik)
- Построение boxplot, scatterplot, heatmap

### 1.2. Feature engineering
- Создание новых признаков
- Бинарные признаки (энкодинг категориальных через OHE)
- Нелинейные преобразования (age_sq, max_torque_ratio, driving_intensity)  
- Производные признаки (age, km_per_year, total_fuel_cost)  

### 1.3. Препроцессинг
- Масштабирование числовых признаков через StandardScaler  
- Подготовка данных в ColumnTransformer + Pipeline  
- Разделение выборки на train и test в пропорции 4:1

### 1.4. Построение и сравнение моделей
- Обучение нескольких моделей (LinearRegression, Lasso, Ridge, Elastic-Net)  
- Подбор гиперпараметров (Через GridSearch)
- Выбор финальной модели для продакшена на основе метрик RMSE, R^2, а также двух бизнес метрик

### 1.5. Разработка Streamlit-приложения
- Интерфейс загрузки CSV  
- Ручной ввод признаков  
- Автоматическая очистка и предобработка  
- Прогноз стоимости  
- Визуализация весов модели  
- Модуль EDA с интерактивными графиками  

---

## 2. Полученные результаты  

### 2.1. Метрики
(Спецификации каждой модели можно найти в **.ipynb** файле. Все метрики рассчитаны на тесте)

| Модель | Бизнес-метрика №1 | Бизнес-метрика №1 | MSE () | R² |
|-------|-----|------|-----|-----|
| gigi_hadid | 0.28 | 1.24 | 43623467428.61 | 0.79 |
| hailey_baldwin | 0.28 | 1.2 | 58910228336.93 | 0.77 |
| kylie_jenner | 0.25 | 1.15 | 93373458176.48  | 0.63 |
| anok_yai | 0.25 | 1.15 | 93373458176.48 | 0.63 |
| kendall_jenner | 0.25 | 1.15 | 93373458176.48 | 0.63 |
| naomi_campbell | 0.24 | 1.14 | 92456194196.82 | 0.64 |
| adriana_lima | 0.24 | 1.15 | 92456194196.82 | 0.64 |
| barbara_palvin | 0.21 | 1.14 | 110807268236.26 | 0.57 |

### 2.2. Интерпретация
- Модель gigi_hadid показала наилучший баланс между устойчивостью и качеством (основное преимущество - наивысшая бизнес метрика и R^2)
- Регуляризация помогла уменьшить переобучение из-за большого признакового пространства

---

## 3. Что дало наибольший прирост качества
- Добавление новых признаков: max_torque_ratio, driving_intensity, km_per_year  
- Нелинейные преобразования (age_sq)  
- Корректная обработка выбросов  
- Настройка регуляризации (особенно Lasso/Ridge)  
- Перебор гиперпараметров по сетке

---

## 4. Что сделать не удалось и почему  
- Некоторые признаки оказались нерелевантными или шумными  
- Высокие выбросы в целевой переменной усложняли обучение  
- Некоторые категориальные признаки плохо интерпретируются моделью  
- Не удалось достичь стабильных результатов на небольшой выборке  
- Некоторые идеи feature engineering не дали прироста  

---

## 5. Оценка разработанного сервиса

### 5.1. Удобство использования
- Интерфейс простой и понятный  
- Есть два метода ввода данных: CSV и ручной ввод  
- Приложение быстро обрабатывает данные  
- Графики генерируются автоматически  

### 5.2. Удачные визуализации
- Распределения числовых признаков  
- Корреляционная матрица  
- Boxplot для бинарных признаков  
- Веса модели  

### 5.3. Менее удачные визуализации
- Pairplot работает медленно на больших данных  
- Веса модели сложнее интерпретировать при большом количестве признаков  
- Некоторые графики требуют более компактного отображения  

### 5.4. Ограничения и проблемы
- Ограниченная интерпретация линейных моделей  
- Возможные проблемы с качеством данных  
- Нет автоматической обработки текстовых признаков  
- Приложение выдаёт ошибку, если не указать все признаки  

---

## 6. План улучшений (вторая итерация)
- Добавить Plotly-графики (интерактивность)  
- Сгенерировать SHAP-объяснения важности признаков  
- Расширить набор моделей  
- Добавить автоматическое определение выбросов  
- Улучшить UI/UX Streamlit-приложения  
- Добавить сохранение истории запросов  

---